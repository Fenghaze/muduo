# 常见并发服务器



# I/O线程和计算线程

- I/O线程（特指网络I/O）：一个reactor（select\poll\epoll）所在的线程就是一个I/O线程
- 计算线程：比较耗费CPU
- 第三方库所用线程：如日志异步线程、数据库访问线程



# 一些场景问题

## Linux同时能启动多少个线程

32位Linux，一个进程虚拟地址空间4G，用户态3G，线程栈空间默认大小约10M，可知，一个进程最多同时启动300个线程

## 线程池大小的选择

如果池中执行任务时，密集计算所占时间比重为$P(0<P<=1)$，而系统一共有$C$个CPU，为了让所有CPU跑满而不过载，线程池大小的经验公式为$T=C/P$，即$C=T*P$

- 假设$C=8,P=1.0$，线程池的任务完全密集计算，只要8个活动线程就可以让CPU饱和
- 假设$C=8,P=0.5$，，线程池的任务有一半是计算，一半是IO，那么$T=16$，也就是16个“50%繁忙的线程”就能让8个CPU饱和

线程太多的缺点：频繁切换会浪费资源